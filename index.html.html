<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Sistema de Vendas de Gado</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f9f9f9; }
    h1 { text-align: center; }
    form, table { margin: 20px auto; width: 90%; max-width: 900px; background: #fff; padding: 15px; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    label { display: block; margin-top: 10px; }
    input, select, button { margin-top: 5px; padding: 8px; width: 100%; }
    table { border-collapse: collapse; }
    table th, table td { border: 1px solid #ddd; padding: 10px; text-align: center; }
    table th { background: #eee; }
    .actions button { margin: 2px; padding: 5px 10px; }
    .search { margin: 20px auto; width: 90%; max-width: 900px; }
  </style>
</head>
<body>
  <h1>Sistema de Vendas de Gado</h1>

  <form id="formGado">
    <label for="nome">Nome do Gado:</label>
    <input type="text" id="nome" required>

    <label for="peso">Peso (kg):</label>
    <input type="number" id="peso" required min="1">

    <label for="preco">Preço (R$):</label>
    <input type="number" id="preco" required min="0.01" step="0.01">

    <label for="categoria">Categoria:</label>
    <select id="categoria" required>
      <option value="Corte">Corte</option>
      <option value="Leite">Leite</option>
      <option value="Reprodução">Reprodução</option>
    </select>

    <button type="submit">Adicionar Gado</button>
  </form>

  <div class="search">
    <label for="busca">Buscar por nome ou categoria:</label>
    <input type="text" id="busca" placeholder="Digite para filtrar...">
  </div>

  <table id="tabelaGado">
    <thead>
      <tr>
        <th>Nome</th>
        <th>Peso (kg)</th>
        <th>Preço (R$)</th>
        <th>Categoria</th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    let gados = JSON.parse(localStorage.getItem("gados")) || [];
    let editIndex = null;

    const form = document.getElementById("formGado");
    const tabela = document.querySelector("#tabelaGado tbody");
    const busca = document.getElementById("busca");

    function salvarLocal() {
      localStorage.setItem("gados", JSON.stringify(gados));
    }

    function renderTabela(filtro = "") {
      tabela.innerHTML = "";
      gados
        .filter(g => g.nome.toLowerCase().includes(filtro.toLowerCase()) || g.categoria.toLowerCase().includes(filtro.toLowerCase()))
        .forEach((gado, index) => {
          let row = document.createElement("tr");
          row.innerHTML = `
            <td>${gado.nome}</td>
            <td>${gado.peso}</td>
            <td>R$ ${parseFloat(gado.preco).toFixed(2)}</td>
            <td>${gado.categoria}</td>
            <td class="actions">
              <button onclick="editar(${index})">Editar</button>
              <button onclick="remover(${index})">Remover</button>
              <button onclick="fatura(${index})">Fatura</button>
            </td>
          `;
          tabela.appendChild(row);
        });
    }

    form.addEventListener("submit", function(e) {
      e.preventDefault();
      const nome = document.getElementById("nome").value.trim();
      const peso = parseFloat(document.getElementById("peso").value);
      const preco = parseFloat(document.getElementById("preco").value);
      const categoria = document.getElementById("categoria").value;

      if (!nome || peso <= 0 || preco <= 0) {
        alert("Preencha todos os campos corretamente.");
        return;
      }

      if (editIndex === null) {
        gados.push({ nome, peso, preco, categoria });
      } else {
        gados[editIndex] = { nome, peso, preco, categoria };
        editIndex = null;
      }

      salvarLocal();
      form.reset();
      renderTabela(busca.value);
    });

    function editar(index) {
      const g = gados[index];
      document.getElementById("nome").value = g.nome;
      document.getElementById("peso").value = g.peso;
      document.getElementById("preco").value = g.preco;
      document.getElementById("categoria").value = g.categoria;
      editIndex = index;
    }

    function remover(index) {
      if (confirm("Deseja realmente remover este gado?")) {
        gados.splice(index, 1);
        salvarLocal();
        renderTabela(busca.value);
      }
    }

    function fatura(index) {
      const g = gados[index];
      let conteudo = `
        <h2>Fatura - Venda de Gado</h2>
        <p><b>Nome:</b> ${g.nome}</p>
        <p><b>Peso:</b> ${g.peso} kg</p>
        <p><b>Preço:</b> R$ ${g.preco.toFixed(2)}</p>
        <p><b>Categoria:</b> ${g.categoria}</p>
        <hr>
        <p><b>Total:</b> R$ ${g.preco.toFixed(2)}</p>
      `;
      let janela = window.open("", "Fatura", "width=600,height=400");
      janela.document.write(conteudo);
      janela.print();
    }

    busca.addEventListener("input", () => renderTabela(busca.value));

    renderTabela();
  </script>
</body>
</html>
